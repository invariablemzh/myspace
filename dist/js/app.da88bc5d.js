(function(e){function t(t){for(var c,r,n=t[0],l=t[1],u=t[2],b=0,p=[];b<n.length;b++)r=n[b],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&p.push(a[r][0]),a[r]=0;for(c in l)Object.prototype.hasOwnProperty.call(l,c)&&(e[c]=l[c]);i&&i(t);while(p.length)p.shift()();return o.push.apply(o,u||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],c=!0,n=1;n<s.length;n++){var l=s[n];0!==a[l]&&(c=!1)}c&&(o.splice(t--,1),e=r(r.s=s[0]))}return e}var c={},a={app:0},o=[];function r(t){if(c[t])return c[t].exports;var s=c[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=c,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)r.d(s,c,function(t){return e[t]}.bind(null,c));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var u=0;u<n.length;u++)t(n[u]);var i=l;o.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"0203":function(e,t,s){"use strict";s("68a1")},"0276":function(e,t,s){"use strict";s("f9a9")},"1be3":function(e,t,s){"use strict";s("b049")},"46bb":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);var c=s("7a23");function a(e,t,s,a,o,r){const n=Object(c["z"])("NavBar"),l=Object(c["z"])("router-view");return Object(c["r"])(),Object(c["f"])(c["a"],null,[Object(c["i"])(n),(Object(c["r"])(),Object(c["d"])(l,{key:e.$route.fullPath}))],64)}s("f9e3"),s("4989");const o={class:"navbar navbar-expand-lg navbar-light bg-light"},r={class:"container-fluid"},n=Object(c["g"])("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[Object(c["g"])("span",{class:"navbar-toggler-icon"})],-1),l={class:"collapse navbar-collapse",id:"navbarText"},u={class:"navbar-nav me-auto mb-2 mb-lg-0"},i={class:"nav-item"},b={class:"nav-item"},p={key:0,class:"navbar-nav"},d={class:"nav-item"},j={class:"nav-item"},O={key:1,class:"navbar-nav"},f={class:"nav-item"},m={class:"nav-item"};function g(e,t,s,a,g,v){const _=Object(c["z"])("router-link");return Object(c["r"])(),Object(c["f"])("nav",o,[Object(c["g"])("div",r,[Object(c["i"])(_,{class:"navbar-brand",to:{name:"home"}},{default:Object(c["F"])(()=>[Object(c["h"])("Myspace")]),_:1}),n,Object(c["g"])("div",l,[Object(c["g"])("ul",u,[Object(c["g"])("li",i,[Object(c["i"])(_,{class:"nav-link",to:{name:"home"}},{default:Object(c["F"])(()=>[Object(c["h"])("首页")]),_:1})]),Object(c["g"])("li",b,[Object(c["i"])(_,{class:"nav-link",to:{name:"userlist"}},{default:Object(c["F"])(()=>[Object(c["h"])("好友列表")]),_:1})])]),e.$store.state.user.is_login?(Object(c["r"])(),Object(c["f"])("ul",O,[Object(c["g"])("li",f,[Object(c["i"])(_,{class:"nav-link",to:{name:"userprofile",params:{userId:e.$store.state.user.username}}},{default:Object(c["F"])(()=>[Object(c["h"])(Object(c["B"])(e.$store.state.user.username),1)]),_:1},8,["to"])]),Object(c["g"])("li",m,[Object(c["g"])("a",{class:"nav-link",style:{cursor:"pointer"},onClick:t[0]||(t[0]=(...e)=>a.logout&&a.logout(...e))},"退出")])])):(Object(c["r"])(),Object(c["f"])("ul",p,[Object(c["g"])("li",d,[Object(c["i"])(_,{class:"nav-link",to:{name:"login"}},{default:Object(c["F"])(()=>[Object(c["h"])("登录")]),_:1})]),Object(c["g"])("li",j,[Object(c["i"])(_,{class:"nav-link",to:{name:"register"}},{default:Object(c["F"])(()=>[Object(c["h"])("注册")]),_:1})])]))])])])}var v=s("5502"),_={name:"NavBar",setup(){const e=Object(v["b"])(),t=()=>{e.commit("logout")};return{logout:t}}},w=s("6b0d"),h=s.n(w);const y=h()(_,[["render",g]]);var B=y,C={name:"App",components:{NavBar:B}};const k=h()(C,[["render",a]]);var P=k,x=s("6605");function U(e,t,s,a,o,r){const n=Object(c["z"])("ContentBase");return Object(c["r"])(),Object(c["d"])(n,null,{default:Object(c["F"])(()=>[Object(c["h"])(" 首页 ")]),_:1})}const z={class:"home"},I={class:"container"},T={class:"card"},F={class:"card-body"};function S(e,t,s,a,o,r){return Object(c["r"])(),Object(c["f"])("div",z,[Object(c["g"])("div",I,[Object(c["g"])("div",T,[Object(c["g"])("div",F,[Object(c["y"])(e.$slots,"default",{},void 0,!0)])])])])}var A={name:"ContentBase"};s("f73d");const D=h()(A,[["render",S],["__scopeId","data-v-3bd6448d"]]);var G=D,V={name:"HomeView",components:{ContentBase:G}};const E=h()(V,[["render",U]]);var L=E;const M=e=>(Object(c["u"])("data-v-144ff57e"),e=e(),Object(c["s"])(),e),$={class:"row justify-content-md-center"},N={class:"col-3"},q={class:"mb-3"},H=M(()=>Object(c["g"])("label",{for:"username",class:"form-label"},"用户名",-1)),W={class:"mb-3"},J=M(()=>Object(c["g"])("label",{for:"password",class:"form-label"},"密码",-1)),K={class:"error-message"},Q=M(()=>Object(c["g"])("button",{type:"submit",class:"btn btn-primary"},"登录",-1));function R(e,t,s,a,o,r){const n=Object(c["z"])("ContentBase");return Object(c["r"])(),Object(c["d"])(n,null,{default:Object(c["F"])(()=>[Object(c["g"])("div",$,[Object(c["g"])("div",N,[Object(c["g"])("form",{onSubmit:t[2]||(t[2]=Object(c["H"])((...e)=>a.login&&a.login(...e),["prevent"]))},[Object(c["g"])("div",q,[H,Object(c["G"])(Object(c["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e),type:"text",class:"form-control",id:"username"},null,512),[[c["D"],a.username]])]),Object(c["g"])("div",W,[J,Object(c["G"])(Object(c["g"])("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),type:"password",class:"form-control",id:"password"},null,512),[[c["D"],a.password]])]),Object(c["g"])("div",K,Object(c["B"])(a.error_message),1),Q],32)])])]),_:1})}s("14d9");var X={name:"LoginView",components:{ContentBase:G},setup(){const e=Object(v["b"])();let t=Object(c["w"])(""),s=Object(c["w"])(""),a=Object(c["w"])("");const o=()=>{a.value="",e.dispatch("login",{username:t.value,password:s.value,success(){mt.push({name:"userlist"})},error(){a.value="用户名或密码错误"}})};return{username:t,password:s,error_message:a,login:o}}};s("0276");const Y=h()(X,[["render",R],["__scopeId","data-v-144ff57e"]]);var Z=Y;function ee(e,t,s,a,o,r){const n=Object(c["z"])("ContentBase");return Object(c["r"])(),Object(c["d"])(n,null,{default:Object(c["F"])(()=>[Object(c["h"])(" 404 ")]),_:1})}var te={name:"NotFound",components:{ContentBase:G}};const se=h()(te,[["render",ee]]);var ce=se;const ae=e=>(Object(c["u"])("data-v-1db57ba6"),e=e(),Object(c["s"])(),e),oe={class:"row justify-content-md-center"},re={class:"col-3"},ne={class:"mb-3"},le=ae(()=>Object(c["g"])("label",{for:"username",class:"form-label"},"用户名",-1)),ue={class:"mb-3"},ie=ae(()=>Object(c["g"])("label",{for:"password",class:"form-label"},"密码",-1)),be={class:"mb-3"},pe=ae(()=>Object(c["g"])("label",{for:"password",class:"form-label"},"确认密码",-1)),de={class:"error-message"},je=ae(()=>Object(c["g"])("button",{type:"submit",class:"btn btn-primary"},"登录",-1));function Oe(e,t,s,a,o,r){const n=Object(c["z"])("ContentBase");return Object(c["r"])(),Object(c["d"])(n,null,{default:Object(c["F"])(()=>[Object(c["g"])("div",oe,[Object(c["g"])("div",re,[Object(c["g"])("form",{onSubmit:t[3]||(t[3]=Object(c["H"])((...e)=>a.register&&a.register(...e),["prevent"]))},[Object(c["g"])("div",ne,[le,Object(c["G"])(Object(c["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e),type:"text",class:"form-control",id:"username"},null,512),[[c["D"],a.username]])]),Object(c["g"])("div",ue,[ie,Object(c["G"])(Object(c["g"])("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),type:"password",class:"form-control",id:"password"},null,512),[[c["D"],a.password]])]),Object(c["g"])("div",be,[pe,Object(c["G"])(Object(c["g"])("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.password_confirm=e),type:"password",class:"form-control",id:"password"},null,512),[[c["D"],a.password_confirm]])]),Object(c["g"])("div",de,Object(c["B"])(a.error_message),1),je],32)])])]),_:1})}var fe=s("1157"),me=s.n(fe),ge={name:"LoginView",components:{ContentBase:G},setup(){const e=Object(v["b"])();let t=Object(c["w"])(""),s=Object(c["w"])(""),a=Object(c["w"])(""),o=Object(c["w"])("");const r=()=>{o.value="",me.a.ajax({url:"https://app165.acapp.acwing.com.cn/myspace/user/",type:"POST",data:{username:t.value,password:s.value,password_confirm:a.value},success(c){"success"===c.result?e.dispatch("login",{username:t.value,password:s.value,success(){mt.push({name:"userlist"})},error(){o.value="系统异常，请稍后重试"}}):o.value=c.result}})};return{username:t,password:s,password_confirm:a,error_message:o,register:r}}};s("8da2");const ve=h()(ge,[["render",Oe],["__scopeId","data-v-1db57ba6"]]);var _e=ve;const we=["onClick"],he={class:"card-body"},ye={class:"row"},Be={class:"col-1 img-field"},Ce=["src"],ke={class:"col-11"},Pe={class:"username"},xe={class:"fans"};function Ue(e,t,s,a,o,r){const n=Object(c["z"])("ContentBase");return Object(c["r"])(),Object(c["d"])(n,null,{default:Object(c["F"])(()=>[(Object(c["r"])(!0),Object(c["f"])(c["a"],null,Object(c["x"])(a.users,e=>(Object(c["r"])(),Object(c["f"])("div",{class:"card",key:e.id,onClick:t=>a.open_user_profile(e.id)},[Object(c["g"])("div",he,[Object(c["g"])("div",ye,[Object(c["g"])("div",Be,[Object(c["g"])("img",{class:"img-fluid",src:e.photo,alt:""},null,8,Ce)]),Object(c["g"])("div",ke,[Object(c["g"])("div",Pe,Object(c["B"])(e.username),1),Object(c["g"])("div",xe,Object(c["B"])(e.followerCount),1)])])])],8,we))),128))]),_:1})}var ze={name:"UserList",components:{ContentBase:G},setup(){const e=Object(v["b"])();let t=Object(c["w"])([]);me.a.ajax({url:"https://app165.acapp.acwing.com.cn/myspace/userlist/?format=json",type:"get",success(e){t.value=e}});const s=t=>{e.state.user.is_login?mt.push({name:"userprofile",params:{userId:t}}):mt.push({name:"login"})};return{users:t,open_user_profile:s}}};s("1be3");const Ie=h()(ze,[["render",Ue],["__scopeId","data-v-cf4ec9be"]]);var Te=Ie;const Fe={class:"row"},Se={class:"col-3"},Ae={class:"col-9"};function De(e,t,s,a,o,r){const n=Object(c["z"])("UserProfileInfo"),l=Object(c["z"])("UserProfileWrite"),u=Object(c["z"])("UserProfilePosts"),i=Object(c["z"])("ContentBase");return Object(c["r"])(),Object(c["d"])(i,null,{default:Object(c["F"])(()=>[Object(c["g"])("div",Fe,[Object(c["g"])("div",Se,[Object(c["i"])(n,{onFollow:a.follow,onUnfollow:a.unfollow,user:a.user},null,8,["onFollow","onUnfollow","user"]),a.is_me?(Object(c["r"])(),Object(c["d"])(l,{key:0,onPost_a_post:a.post_a_post},null,8,["onPost_a_post"])):Object(c["e"])("",!0)]),Object(c["g"])("div",Ae,[Object(c["i"])(u,{user:a.user,posts:a.posts,onDelete_a_post:a.delete_a_post},null,8,["user","posts","onDelete_a_post"])])])]),_:1})}s("3c65");const Ge={class:"card"},Ve={class:"card-body"},Ee={class:"row"},Le={class:"col-3 img-field"},Me=["src"],$e={class:"col-9"},Ne={class:"username"},qe={class:"fans"};function He(e,t,s,a,o,r){return Object(c["r"])(),Object(c["f"])("div",Ge,[Object(c["g"])("div",Ve,[Object(c["g"])("div",Ee,[Object(c["g"])("div",Le,[Object(c["g"])("img",{class:"img-fluid",src:s.user.photo,alt:""},null,8,Me)]),Object(c["g"])("div",$e,[Object(c["g"])("div",Ne,Object(c["B"])(s.user.username),1),Object(c["g"])("div",qe,"粉丝："+Object(c["B"])(s.user.followerCount),1),s.user.is_followed?Object(c["e"])("",!0):(Object(c["r"])(),Object(c["f"])("button",{key:0,onClick:t[0]||(t[0]=(...e)=>a.follow&&a.follow(...e)),type:"button",class:"btn btn-secondary btn-sm"},"+关注")),s.user.is_followed?(Object(c["r"])(),Object(c["f"])("button",{key:1,onClick:t[1]||(t[1]=(...e)=>a.unfollow&&a.unfollow(...e)),type:"button",class:"btn btn-secondary btn-sm"},"+取消关注")):Object(c["e"])("",!0)])])])])}var We={name:"UserProfileInfo",props:{user:{type:Object,required:!0}},setup(e,t){const s=Object(v["b"])(),c=()=>{me.a.ajax({url:"https://app165.acapp.acwing.com.cn/myspace/follow/",type:"POST",data:{target_id:e.user.id},headers:{Authorization:"Bearer "+s.state.user.access},success(e){"success"===e.result&&t.emit("follow")}})},a=()=>{me.a.ajax({url:"https://app165.acapp.acwing.com.cn/myspace/follow/",type:"POST",data:{target_id:e.user.id},headers:{Authorization:"Bearer "+s.state.user.access},success(e){"success"===e.result&&t.emit("unfollow")}})};return{follow:c,unfollow:a}}};s("7d3f");const Je=h()(We,[["render",He],["__scopeId","data-v-02174aca"]]);var Ke=Je;const Qe={class:"card"},Re={class:"card-body"},Xe={class:"card single-post"},Ye={class:"card-body"},Ze=["onClick"];function et(e,t,s,a,o,r){return Object(c["r"])(),Object(c["f"])("div",Qe,[Object(c["g"])("div",Re,[(Object(c["r"])(!0),Object(c["f"])(c["a"],null,Object(c["x"])(s.posts.posts,e=>(Object(c["r"])(),Object(c["f"])("div",{key:e.id},[Object(c["g"])("div",Xe,[Object(c["g"])("div",Ye,[Object(c["h"])(Object(c["B"])(e.content)+" ",1),Object(c["g"])("button",{onClick:t=>a.delete_a_post(e.id),type:"button",class:"btn btn-danger btn-sm"},"删除",8,Ze)])])]))),128))])])}var tt={name:"UserProfilePosts",props:{posts:{type:Object,required:!0},user:{type:Object,required:!0}},setup(e,t){const s=Object(v["b"])();let a=Object(c["b"])(()=>s.state.user.id===e.user.id);const o=e=>{me.a.ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"DELETE",data:{post_id:e},headers:{Authorization:"Bearer "+s.state.user.access},success(s){"success"===s.result&&t.emit("delete_a_post",e)}})};return{is_me:a,delete_a_post:o}}};s("709e");const st=h()(tt,[["render",et],["__scopeId","data-v-5f2d0fea"]]);var ct=st;const at=e=>(Object(c["u"])("data-v-9593cb74"),e=e(),Object(c["s"])(),e),ot={class:"card edit-up"},rt={class:"card-body"},nt=at(()=>Object(c["g"])("label",{for:"edit-field",class:"form-label"},"编辑帖子",-1));function lt(e,t,s,a,o,r){return Object(c["r"])(),Object(c["f"])("div",ot,[Object(c["g"])("div",rt,[nt,Object(c["G"])(Object(c["g"])("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.content=e),class:"form-control",id:"edit-field",rows:"3"},null,512),[[c["D"],a.content]]),Object(c["g"])("button",{onClick:t[1]||(t[1]=(...e)=>a.post_a_post&&a.post_a_post(...e)),type:"button",class:"btn btn-primary btn-sm"},"发帖")])])}var ut={name:"UserProfileWrite",setup(e,t){const s=Object(v["b"])();let a=Object(c["w"])("");const o=()=>{me.a.ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"POST",data:{content:a.value},headers:{Authorization:"Bearer "+s.state.user.access},success(e){"success"===e.result&&(t.emit("post_a_post",a.value),a.value="")}})};return{content:a,post_a_post:o}}};s("0203");const it=h()(ut,[["render",lt],["__scopeId","data-v-9593cb74"]]);var bt=it,pt={name:"UserList",components:{ContentBase:G,UserProfileInfo:Ke,UserProfilePosts:ct,UserProfileWrite:bt},setup(){const e=Object(v["b"])(),t=Object(x["c"])(),s=t.params.userId,a=Object(c["v"])({}),o=Object(c["v"])({});me.a.ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:s},headers:{Authorization:"Bearer "+e.state.user.access},success(e){a.id=e.id,a.username=e.username,a.photo=e.photo,a.followerCount=e.followerCount,a.is_followed=e.is_followed}}),me.a.ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"GET",data:{user_id:s},headers:{Authorization:"Bearer "+e.state.user.access},success(e){o.count=e.length,o.posts=e}});const r=()=>{a.is_followed||(a.is_followed=!0,a.followerCount++)},n=()=>{a.is_followed&&(a.is_followed=!1,a.followerCount--)},l=e=>{o.count++,o.posts.unshift({id:o.count,userId:1,content:e})},u=e=>{o.posts=o.posts.filter(t=>t.id!==e),o.count=o.posts.length},i=Object(c["b"])(()=>s===e.state.user.id);return{user:a,follow:r,unfollow:n,posts:o,post_a_post:l,is_me:i,delete_a_post:u}}};s("6208");const dt=h()(pt,[["render",De],["__scopeId","data-v-6a55c940"]]);var jt=dt;const Ot=[{path:"/",name:"home",component:L},{path:"/login/",name:"login",component:Z},{path:"/register/",name:"register",component:_e},{path:"/404/",name:"404",component:ce},{path:"/userlist/",name:"userlist",component:Te},{path:"/userprofile/:userId/",name:"userprofile",component:jt},{path:"/:catchAll(.*)",redirect:"/404/"}],ft=Object(x["a"])({history:Object(x["b"])(),routes:Ot});var mt=ft,gt=s("1232");const vt={state:{id:"",username:"",photo:"",followerCount:0,access:"",refresh:"",is_login:!1},getters:{},mutations:{updateUser(e,t){e.id=t.id,e.username=t.username,e.photo=t.photo,e.followerCount=t.followerCount,e.access=t.access,e.refresh=t.refresh,e.is_login=t.is_login},updateAccess(e,t){e.access=t},logout(e){e.id="",e.username="",e.photo="",e.followerCount=0,e.access="",e.refresh="",e.is_login=!1}},actions:{login(e,t){me.a.ajax({url:"https://app165.acapp.acwing.com.cn/api/token/",type:"POST",data:{username:t.username,password:t.password},success(s){const{access:c,refresh:a}=s,o=Object(gt["a"])(c);setInterval(()=>{me.a.ajax({url:"https://app165.acapp.acwing.com.cn/api/token/refresh/",type:"POST",data:{refresh:a},success(t){e.commit("updateAccess",t.access)}})},27e4),me.a.ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:o.user_id},headers:{Authorization:"Bearer "+c},success(s){e.commit("updateUser",{...s,access:c,refresh:a,is_login:!0}),t.success()}})},error(){t.error()}})}},modules:{}};var _t=vt,wt=Object(v["a"])({state:{},getters:{},mutations:{},actions:{},modules:{user:_t}});Object(c["c"])(P).use(wt).use(wt).use(mt).use(mt).mount("#app")},6208:function(e,t,s){"use strict";s("b403")},6229:function(e,t,s){},"68a1":function(e,t,s){},"709e":function(e,t,s){"use strict";s("7e6b")},"7d3f":function(e,t,s){"use strict";s("a87d")},"7e6b":function(e,t,s){},"8da2":function(e,t,s){"use strict";s("6229")},a87d:function(e,t,s){},b049:function(e,t,s){},b403:function(e,t,s){},f73d:function(e,t,s){"use strict";s("46bb")},f9a9:function(e,t,s){}});
//# sourceMappingURL=app.da88bc5d.js.map